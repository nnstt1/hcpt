# hcpt

A CLI tool for retrieving HCP Terraform configurations and workspace information.

[日本語](README.ja.md)

## Installation

### Go install

```bash
go install github.com/nnstt1/hcpt@latest
```

### GitHub Releases

Download binaries from [Releases](https://github.com/nnstt1/hcpt/releases).

## Authentication

API tokens are resolved in the following priority order:

1. `TFE_TOKEN` environment variable
2. `token` field in `~/.hcpt.yaml`
3. Terraform CLI credentials (checked in the following order)
   1. `TF_TOKEN_<hostname>` environment variable (dots and dashes in hostname are replaced with underscores, e.g. `TF_TOKEN_app_terraform_io`)
   2. `~/.terraform.d/credentials.tfrc.json` (JSON generated by `terraform login`)
   3. `~/.terraformrc` (HCL credentials block)

If you have already authenticated with `terraform login`, hcpt works without additional configuration.

```bash
# Use directly after terraform login
terraform login
hcpt org list
```

```yaml
# ~/.hcpt.yaml
token: "your-api-token"
address: "https://app.terraform.io"  # default
org: "my-organization"
```

The address can also be set via the `TFE_ADDRESS` environment variable.

The path to `~/.terraformrc` can be overridden with the `TF_CLI_CONFIG_FILE` environment variable.

## Usage

### List Organizations

```bash
hcpt org list
```

### List Workspaces

```bash
hcpt workspace list --org my-org

# Search by name
hcpt workspace list --org my-org --search "prod"

# Alias `ws` is also available
hcpt ws list --org my-org
```

### Show Workspace Details

```bash
hcpt workspace show my-workspace --org my-org
```

### List Runs

```bash
hcpt run list --org my-org -w my-workspace
```

### Common Options

| Flag | Description |
|------|-------------|
| `--org` | Organization name (can also be set in config file or environment variable) |
| `--json` | Output in JSON format |
| `--config` | Config file path (default: `~/.hcpt.yaml`) |

## Development

```bash
# Build
make build

# Test
make test

# Lint
make lint

# Clean
make clean
```

## License

MIT
